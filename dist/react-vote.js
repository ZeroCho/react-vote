module.exports=function(e){function t(a){if(o[a])return o[a].exports;var s=o[a]={exports:{},id:a,loaded:!1};return e[a].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var o={};return t.m=e,t.c=o,t.p="",t(0)}([function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e},p=function(){function e(e,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,o,a){return o&&e(t.prototype,o),a&&e(t,a),t}}(),i=o(1),u=a(i),d=function(e){function t(){var e,o,a,n;s(this,t);for(var p=arguments.length,i=Array(p),d=0;d<p;d++)i[d]=arguments[d];return o=a=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),a.state={showResult:!1,items:a.props.data?a.props.data.items:[],data:l({},a.props.data,{title:a.props.data&&a.props.data.title,items:a.props.data&&a.props.data.items,voters:a.props.data&&a.props.data.voters||[],done:a.props.data&&a.props.data.done||!1,closed:a.props.data&&a.props.data.closed||!1}),isAdmin:a.props.isAdmin,total:a.props.total,expansion:a.props.expansion,voted:a.props.clientId&&!a.props.multiple&&a.props.data.voters&&a.props.data.voters.indexOf(a.props.clientId)>-1||!1,multiple:a.props.multiple,showMessage:!1,errorMessage:!1,autoClose:a.props.autoClose},a.addItem=function(){var e=a.addInput.value,t=a.state.items;e&&e.trim()&&(t.push({title:e,count:0}),a.setState({items:t}),a.addInput.value="")},a.removeItem=function(e){var t=a.state.items,o=a[e].innerHTML;t=t.filter(function(e){return e.title!==o}),a.setState({items:t})},a.createVote=function(){var e=a.state.items,t=a.voteTitle.value,o=a.multipleCheck.checked,s=a.expansionCheck.checked,r=!!a.autoClose.value&&parseInt(a.autoClose.value,10),n={title:t,items:e,multiple:o,expansion:s,done:!1,closed:!1};return r&&!Number.isNaN(r)&&(n.autoClose=r),console.log(r,n),t&&t.trim()?n.items.length<2?a.setState({showMessage:!0,errorMessage:a.props.errorMessage.notEnoughItems}):(a.setState({data:n,showMessage:!1,multiple:o,expansion:s,autoClose:r,items:e}),a.props.getData&&a.props.getData(n)):a.setState({showMessage:!0,errorMessage:a.props.errorMessage.noTitle})},a.expandVote=function(){var e=a.expansionInput.value;if(!e||!e.trim())return!1;var t=a.state.data,o={title:e,count:0};return t.items.push(o),a.setState({data:t,items:t.items}),a.expansionInput.value="",a.props.getData&&a.props.getData(t)},a.showResult=function(){a.setState({showResult:!0})},a.showVoting=function(){a.setState({showResult:!1})},a.closeVote=function(){var e=a.state.data;return e.done=!0,e.closed=!0,a.setState({data:e}),a.props.getData&&a.props.getData(e)},a.upvote=function(e){var t=a.state.items,o=a.state.data,s=t.reduce(function(e,t){return e+t.count},0);if(s===a.state.autoClose)return a.closeVote();t[e].count+=1,t[e].voted=!0;var r=a.props.clientId;return t[e].voters||(t[e].voters=[]),t[e].voters.push(r),o.items=t,o.voters?o.voters.indexOf(r)===-1&&o.voters.push(r):o.voters=[r],a.setState({voted:!0,items:t,data:o}),a.props.getData&&a.props.getData(o)},a.renderItems=function(e){var t=0;return u.default.createElement("div",null,e.map(function(e){var o=t,s=a.props,r=s.styles,n=s.text,l=s.clientId,p=l&&e.voters&&e.voters.indexOf(l)>-1,i=e.voted||p?u.default.createElement("span",{className:r.votedText},n.votedText):(a.state.multiple||!a.state.voted)&&u.default.createElement("button",{onClick:function(){return a.upvote(o)},className:r.voteButton},n.voteButtonText),d=u.default.createElement("div",{key:"react-vote-item-"+o,className:r.itemWrapper},u.default.createElement("div",{className:r.itemTitle,ref:function(e){a["react-vote-item-"+o]=e}},e.title),a.state.data.title?i:u.default.createElement("button",{onClick:function(){return a.removeItem("react-vote-item-"+o)},className:r.removeButton},n.removeButtonText));return t+=1,d}))},a.renderResult=function(e){var t=0,o=e.reduce(function(e,t){return e+t.count},0),s=a.props.styles,r=a.props.clientId&&!a.state.multiple&&a.state.data.voters.indexOf(a.props.clientId)>-1,n=a.props.text;return u.default.createElement("div",null,u.default.createElement("div",{className:s.voteTitle},a.state.data.title),u.default.createElement("div",null,e.map(function(e){var r=0===o?0:(e.count/o*100).toFixed(2),n=u.default.createElement("div",{key:"react-vote-result-"+t,className:s.itemWrapper},u.default.createElement("div",{className:s.itemTitle,ref:function(e){a["react-vote-result-"+t]=e}},e.title),u.default.createElement("div",{className:s.itemCount},e.count+"("+r+"%)"));return t+=1,n}),a.state.total&&u.default.createElement("div",{className:s.itemWrapper},u.default.createElement("div",{className:s.itemTitle},n.totalText),u.default.createElement("div",{className:s.itemCount},o))),!a.state.data.done&&!a.state.data.closed&&!r&&u.default.createElement("div",{className:s.buttonWrapper},u.default.createElement("button",{className:s.goBackButton,onClick:a.showVoting},n.goBackButtonText)))},n=o,r(a,n)}return n(t,e),p(t,[{key:"componentWillMount",value:function(){this.props.data&&this.props.data.done&&console.error("data.done is deprecated. Please use data.closed instead. data.done prop will be deleted next update and it will break your application")}},{key:"componentWillReceiveProps",value:function(e){e.data&&this.setState({data:e.data,items:e.data.items,isAdmin:e.isAdmin})}},{key:"renderCreationView",value:function(){var e=this,t=this.props,o=t.styles,a=t.text;return u.default.createElement("div",null,u.default.createElement("input",{className:o.titleInput,ref:function(t){e.voteTitle=t},placeholder:a.titleInputPlaceholder}),u.default.createElement("div",{className:o.addWrapper},this.renderItems(this.state.items),u.default.createElement("div",null,u.default.createElement("input",{className:o.addInput,ref:function(t){e.addInput=t},placeholder:a.addInputPlaceholder}),u.default.createElement("button",{className:o.addButton,onClick:this.addItem},a.addButtonText)),u.default.createElement("div",null,u.default.createElement("label",{htmlFor:"multiple"},u.default.createElement("input",{id:"multiple",type:"checkbox",ref:function(t){e.multipleCheck=t}}),a.multipleCheckbox),u.default.createElement("label",{htmlFor:"expansion"},u.default.createElement("input",{id:"expansion",type:"checkbox",ref:function(t){e.expansionCheck=t}}),a.expansionCheckbox),u.default.createElement("label",{htmlFor:"autoClose"},"autoClose: ",u.default.createElement("input",{id:"autoClose",ref:function(t){e.autoClose=t}})))),this.state.showMessage&&u.default.createElement("div",{className:o.errorMessage},this.state.errorMessage),u.default.createElement("div",{className:o.buttonWrapper},u.default.createElement("button",{className:o.createButton,onClick:this.createVote},a.createButtonText)))}},{key:"render",value:function(){var e=this,t=this.props,o=t.styles,a=t.text,s=t.clientId,r=s&&!this.state.multiple&&this.state.data.voters.indexOf(s)>-1,n=this.state.data.done||this.state.data.closed,l=this.state.data.title&&(n||this.state.showResult||r),p=this.state.expansion&&(!this.state.voted||this.state.multiple),i=l?this.renderResult(this.state.items):u.default.createElement("div",null,u.default.createElement("div",{className:o.voteTitle},this.state.data.title),this.renderItems(this.state.items),p&&u.default.createElement("div",{className:o.itemWrapper},u.default.createElement("input",{className:o.expansionInput,ref:function(t){e.expansionInput=t},placeholder:a.expansionPlaceholder}),u.default.createElement("button",{className:o.expansionButton,onClick:this.expandVote},a.expansionButtonText)),u.default.createElement("div",{className:o.buttonWrapper},u.default.createElement("button",{className:o.resultButton,onClick:this.showResult},a.resultButtonText),this.state.isAdmin&&u.default.createElement("button",{className:o.closeButton,onClick:this.closeVote},a.closeButtonText)));return u.default.createElement("div",{className:o.voteWrapper},this.state.data.title?i:this.renderCreationView())}}]),t}(i.Component);d.propTypes={isAdmin:i.PropTypes.bool,total:i.PropTypes.bool,multiple:i.PropTypes.bool,clientId:i.PropTypes.oneOfType([i.PropTypes.string,i.PropTypes.number]),data:i.PropTypes.shape({title:i.PropTypes.string.isRequired,voters:i.PropTypes.arrayOf(i.PropTypes.oneOfType([i.PropTypes.string,i.PropTypes.number])),items:i.PropTypes.arrayOf(i.PropTypes.object).isRequired,done:i.PropTypes.bool,closed:i.PropTypes.bool}),autoClose:i.PropTypes.number,expansion:i.PropTypes.bool,styles:i.PropTypes.shape({voteWrapper:i.PropTypes.string,voteTitle:i.PropTypes.string,titleInput:i.PropTypes.string,addWrapper:i.PropTypes.string,addInput:i.PropTypes.string,addButton:i.PropTypes.string,itemTitle:i.PropTypes.string,itemCount:i.PropTypes.string,itemWrapper:i.PropTypes.string,buttonWrapper:i.PropTypes.string,removeButton:i.PropTypes.string,createButton:i.PropTypes.string,resultButton:i.PropTypes.string,goBackButton:i.PropTypes.string,voteButton:i.PropTypes.string,closeButton:i.PropTypes.string,errorMessage:i.PropTypes.string,votedText:i.PropTypes.string,expansionButton:i.PropTypes.string,expansionInput:i.PropTypes.string}),getData:i.PropTypes.func,text:i.PropTypes.shape({titleInputPlaceholder:i.PropTypes.string,addInputPlaceholder:i.PropTypes.string,addButtonText:i.PropTypes.string,removeButtonText:i.PropTypes.string,closeButtonText:i.PropTypes.string,createButtonText:i.PropTypes.string,resultButtonText:i.PropTypes.string,goBackButtonText:i.PropTypes.string,voteButtonText:i.PropTypes.string,votedText:i.PropTypes.string,totalText:i.PropTypes.string,multipleCheckbox:i.PropTypes.string,expansionCheckbox:i.PropTypes.string,expansionPlaceholder:i.PropTypes.string,expansionButtonText:i.PropTypes.string}),errorMessage:i.PropTypes.shape({notEnoughItems:i.PropTypes.string,noTitle:i.PropTypes.string})},d.defaultProps={isAdmin:!1,multiple:!1,total:!0,expansion:!1,voted:!1,text:{addButtonText:"Add",titleInputPlaceholder:"Title of this vote",addInputPlaceholder:"Type title of new option here",removeButtonText:"×",closeButtonText:"Close vote",createButtonText:"Create",resultButtonText:"Show result",goBackButtonText:"Go back to vote",voteButtonText:"Upvote",votedText:"Voted",totalText:"Total",multipleCheckbox:"multiple?",expansionCheckbox:"expansion?",expansionPlaceholder:"Add an option yourself",expansionButtonText:"Add"},errorMessage:{notEnoughItems:"Need at least 2 item!",noTitle:"Need a title!"},styles:{}},t.default=d},function(e,t){e.exports=require("react")}]);
//# sourceMappingURL=react-vote.js.map