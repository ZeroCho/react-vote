module.exports=function(e){function t(s){if(o[s])return o[s].exports;var a=o[s]={exports:{},id:s,loaded:!1};return e[s].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var o={};return t.m=e,t.c=o,t.p="",t(0)}([function(e,t,o){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s])}return e},p=function(){function e(e,t){for(var o=0;o<t.length;o++){var s=t[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,o,s){return o&&e(t.prototype,o),s&&e(t,s),t}}(),i=o(1),u=s(i),c=function(e){function t(){var e,o,s,n;a(this,t);for(var p=arguments.length,i=Array(p),c=0;c<p;c++)i[c]=arguments[c];return o=s=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),s.state={showResult:!1,items:s.props.data?s.props.data.items:[],data:l({},s.props.data,{title:s.props.data&&s.props.data.title,items:s.props.data&&s.props.data.items,voters:s.props.data&&s.props.data.voters||[],closed:s.props.data&&s.props.data.closed||!1}),isAdmin:s.props.isAdmin,total:s.props.total,expansion:s.props.expansion,voted:s.props.clientId&&!s.props.multiple&&s.props.data.voters&&s.props.data.voters.indexOf(s.props.clientId)>-1||!1,multiple:s.props.multiple,showMessage:!1,errorMessage:!1,autoClose:s.props.autoClose},s.addItem=function(){var e=s.addInput.value,t=s.state.items;e&&e.trim()&&(t.push({title:e,count:0}),s.setState({items:t}),s.addInput.value="")},s.removeItem=function(e){var t=s.state.items,o=s[e].innerHTML;t=t.filter(function(e){return e.title!==o}),s.setState({items:t})},s.createVote=function(){var e=s.state.items,t=s.voteTitle.value,o=s.multipleCheck.checked,a=s.expansionCheck.checked,r=!!s.autoClose.value&&parseInt(s.autoClose.value,10),n={title:t,items:e,multiple:o,expansion:a,closed:!1};return r&&!Number.isNaN(r)&&(n.autoClose=r),t&&t.trim()?n.items.length<2?s.setState({showMessage:!0,errorMessage:s.props.errorMessage.notEnoughItems}):(s.setState({data:n,showMessage:!1,multiple:o,expansion:a,autoClose:r,items:e}),s.props.getData&&s.props.getData(n)):s.setState({showMessage:!0,errorMessage:s.props.errorMessage.noTitle})},s.expandVote=function(){var e=s.expansionInput.value;if(!e||!e.trim())return!1;var t=s.state.data,o={title:e,count:0};return t.items.push(o),s.setState({data:t,items:t.items}),s.expansionInput.value="",s.props.getData&&s.props.getData(t)},s.showResult=function(){s.setState({showResult:!0})},s.showVoting=function(){s.setState({showResult:!1})},s.closeVote=function(){var e=s.state.data;return e.closed=!0,s.setState({data:e}),s.props.getData&&s.props.getData(e)},s.upvote=function(e){var t=s.state.items,o=s.state.data,a=t.reduce(function(e,t){return e+t.count},0);t[e].count+=1,t[e].voted=!0;var r=s.props.clientId;return t[e].voters||(t[e].voters=[]),t[e].voters.push(r),o.items=t,o.voters?o.voters.indexOf(r)===-1&&o.voters.push(r):o.voters=[r],s.setState({voted:!0,items:t,data:o}),a+1>=s.state.autoClose?s.closeVote():s.props.getData&&s.props.getData(o)},s.renderItems=function(e){var t=0;return u.default.createElement("div",null,e.map(function(e){var o=t,a=s.props,r=a.styles,n=a.text,l=a.clientId,p=l&&e.voters&&e.voters.indexOf(l)>-1,i=e.voted||p?u.default.createElement("span",{className:r.votedText},n.votedText):(s.state.multiple||!s.state.voted)&&u.default.createElement("button",{onClick:function(){return s.upvote(o)},className:r.voteButton},n.voteButtonText),c=u.default.createElement("div",{key:"react-vote-item-"+o,className:r.itemWrapper},u.default.createElement("div",{className:r.itemTitle,ref:function(e){s["react-vote-item-"+o]=e}},e.title),s.state.data.title?i:u.default.createElement("button",{onClick:function(){return s.removeItem("react-vote-item-"+o)},className:r.removeButton},n.removeButtonText));return t+=1,c}))},s.renderResult=function(e){var t=0,o=e.reduce(function(e,t){return e+t.count},0),a=s.props.styles,r=s.props.clientId&&!s.state.multiple&&s.state.data.voters.indexOf(s.props.clientId)>-1,n=s.props.text;return u.default.createElement("div",null,u.default.createElement("div",{className:a.voteTitle},s.state.data.title),u.default.createElement("div",null,e.map(function(e){var r=0===o?0:(e.count/o*100).toFixed(2),n=u.default.createElement("div",{key:"react-vote-result-"+t,className:a.itemWrapper},u.default.createElement("div",{className:a.itemTitle,ref:function(e){s["react-vote-result-"+t]=e}},e.title),u.default.createElement("div",{className:a.itemCount},e.count+"("+r+"%)"));return t+=1,n}),s.state.total&&u.default.createElement("div",{className:a.itemWrapper},u.default.createElement("div",{className:a.itemTitle},n.totalText),u.default.createElement("div",{className:a.itemCount},o))),!s.state.data.closed&&!r&&u.default.createElement("div",{className:a.buttonWrapper},u.default.createElement("button",{className:a.goBackButton,onClick:s.showVoting},n.goBackButtonText)))},n=o,r(s,n)}return n(t,e),p(t,[{key:"componentWillReceiveProps",value:function(e){e.data&&this.setState({data:e.data,items:e.data.items,isAdmin:e.isAdmin})}},{key:"renderCreationView",value:function(){var e=this,t=this.props,o=t.styles,s=t.text;return u.default.createElement("div",null,u.default.createElement("input",{className:o.titleInput,ref:function(t){e.voteTitle=t},placeholder:s.titleInputPlaceholder}),u.default.createElement("div",{className:o.addWrapper},this.renderItems(this.state.items),u.default.createElement("div",null,u.default.createElement("input",{className:o.addInput,ref:function(t){e.addInput=t},placeholder:s.addInputPlaceholder}),u.default.createElement("button",{className:o.addButton,onClick:this.addItem},s.addButtonText)),u.default.createElement("div",null,u.default.createElement("label",{htmlFor:"multiple"},u.default.createElement("input",{id:"multiple",type:"checkbox",ref:function(t){e.multipleCheck=t}}),s.multipleCheckbox)," ",u.default.createElement("label",{htmlFor:"expansion"},u.default.createElement("input",{id:"expansion",type:"checkbox",ref:function(t){e.expansionCheck=t}}),s.expansionCheckbox)," ",u.default.createElement("label",{htmlFor:"autoClose"},"autoClose: ",u.default.createElement("input",{id:"autoClose",ref:function(t){e.autoClose=t}})))),this.state.showMessage&&u.default.createElement("div",{className:o.errorMessage},this.state.errorMessage),u.default.createElement("div",{className:o.buttonWrapper},u.default.createElement("button",{className:o.createButton,onClick:this.createVote},s.createButtonText)))}},{key:"render",value:function(){var e=this,t=this.props,o=t.styles,s=t.text,a=t.clientId,r=a&&!this.state.multiple&&this.state.data.voters.indexOf(a)>-1,n=this.state.data.closed,l=this.state.data.title&&(n||this.state.showResult||r),p=this.state.expansion&&(!this.state.voted||this.state.multiple),i=l?this.renderResult(this.state.items):u.default.createElement("div",null,u.default.createElement("div",{className:o.voteTitle},this.state.data.title),this.renderItems(this.state.items),p&&u.default.createElement("div",{className:o.itemWrapper},u.default.createElement("input",{className:o.expansionInput,ref:function(t){e.expansionInput=t},placeholder:s.expansionPlaceholder}),u.default.createElement("button",{className:o.expansionButton,onClick:this.expandVote},s.expansionButtonText)),u.default.createElement("div",{className:o.buttonWrapper},u.default.createElement("button",{className:o.resultButton,onClick:this.showResult},s.resultButtonText),this.state.isAdmin&&u.default.createElement("button",{className:o.closeButton,onClick:this.closeVote},s.closeButtonText)));return u.default.createElement("div",{className:o.voteWrapper},this.state.data.title?i:this.renderCreationView())}}]),t}(i.Component);c.propTypes={isAdmin:i.PropTypes.bool,total:i.PropTypes.bool,multiple:i.PropTypes.bool,clientId:i.PropTypes.oneOfType([i.PropTypes.string,i.PropTypes.number]),data:i.PropTypes.shape({title:i.PropTypes.string.isRequired,voters:i.PropTypes.arrayOf(i.PropTypes.oneOfType([i.PropTypes.string,i.PropTypes.number])),items:i.PropTypes.arrayOf(i.PropTypes.object).isRequired,closed:i.PropTypes.bool}),autoClose:i.PropTypes.number,expansion:i.PropTypes.bool,styles:i.PropTypes.shape({voteWrapper:i.PropTypes.string,voteTitle:i.PropTypes.string,titleInput:i.PropTypes.string,addWrapper:i.PropTypes.string,addInput:i.PropTypes.string,addButton:i.PropTypes.string,itemTitle:i.PropTypes.string,itemCount:i.PropTypes.string,itemWrapper:i.PropTypes.string,buttonWrapper:i.PropTypes.string,removeButton:i.PropTypes.string,createButton:i.PropTypes.string,resultButton:i.PropTypes.string,goBackButton:i.PropTypes.string,voteButton:i.PropTypes.string,closeButton:i.PropTypes.string,errorMessage:i.PropTypes.string,votedText:i.PropTypes.string,expansionButton:i.PropTypes.string,expansionInput:i.PropTypes.string}),getData:i.PropTypes.func,text:i.PropTypes.shape({titleInputPlaceholder:i.PropTypes.string,addInputPlaceholder:i.PropTypes.string,addButtonText:i.PropTypes.string,removeButtonText:i.PropTypes.string,closeButtonText:i.PropTypes.string,createButtonText:i.PropTypes.string,resultButtonText:i.PropTypes.string,goBackButtonText:i.PropTypes.string,voteButtonText:i.PropTypes.string,votedText:i.PropTypes.string,totalText:i.PropTypes.string,multipleCheckbox:i.PropTypes.string,expansionCheckbox:i.PropTypes.string,expansionPlaceholder:i.PropTypes.string,expansionButtonText:i.PropTypes.string}),errorMessage:i.PropTypes.shape({notEnoughItems:i.PropTypes.string,noTitle:i.PropTypes.string})},c.defaultProps={isAdmin:!1,multiple:!1,total:!0,expansion:!1,voted:!1,text:{addButtonText:"Add",titleInputPlaceholder:"Title of this vote",addInputPlaceholder:"Type title of new option here",removeButtonText:"×",closeButtonText:"Close vote",createButtonText:"Create",resultButtonText:"Show result",goBackButtonText:"Go back to vote",voteButtonText:"Upvote",votedText:"Voted",totalText:"Total",multipleCheckbox:"multiple?",expansionCheckbox:"expansion?",expansionPlaceholder:"Add an option yourself",expansionButtonText:"Add"},errorMessage:{notEnoughItems:"Need at least 2 item!",noTitle:"Need a title!"},styles:{}},t.default=c},function(e,t){e.exports=require("react")}]);
//# sourceMappingURL=react-vote.js.map