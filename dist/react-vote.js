module.exports=function(e){function t(a){if(o[a])return o[a].exports;var s=o[a]={exports:{},id:a,loaded:!1};return e[a].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var o={};return t.m=e,t.c=o,t.p="",t(0)}([function(e,t,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e},p=function(){function e(e,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,o,a){return o&&e(t.prototype,o),a&&e(t,a),t}}(),i=o(1),u=a(i),c=function(e){function t(){var e,o,a,r;s(this,t);for(var p=arguments.length,i=Array(p),c=0;c<p;c++)i[c]=arguments[c];return o=a=n(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),a.state={showResult:!1,items:a.props.data?a.props.data.items:[],data:l({},a.props.data,{title:a.props.data&&a.props.data.title,items:a.props.data&&a.props.data.items,voters:a.props.data&&a.props.data.voters||[],closed:a.props.data&&a.props.data.closed||!1}),isAdmin:a.props.isAdmin,total:a.props.total,expansion:a.props.expansion,voted:a.props.clientId&&!a.props.multiple&&a.props.data.voters&&a.props.data.voters.indexOf(a.props.clientId)>-1||!1,multiple:a.props.multiple,showMessage:!1,errorMessage:!1,autoClose:a.props.autoClose,voteTitle:"",addInput:"",autoCloseNumber:null,multipleCheck:!1,expansionCheck:!1,expansionInput:""},a.onVoteTitleChange=function(e){a.setState({voteTitle:e.target.value})},a.onAddInputChange=function(e){a.setState({addInput:e.target.value})},a.onMultipleCheckChange=function(e){a.setState({multipleCheck:e.target.checked})},a.onExpansionCheckChange=function(e){a.setState({expansionCheck:e.target.checked})},a.onAutoCloseChange=function(e){a.setState({autoCloseNumber:e.target.value})},a.onExpansionInputChange=function(e){a.setState({expansionInput:e.target.value})},a.addItem=function(){var e=a.state.addInput,t=a.state.items;e&&e.trim()&&(t.push({title:e,count:0}),a.setState({items:t,addInput:""}))},a.removeItem=function(e){var t=a.state.items;t=t.filter(function(t,o){return o!==e}),a.setState({items:t})},a.createVote=function(){var e=a.props,t=e.onCreate,o=e.getData,s=e.errorMessage,n=s.noTitle,r=s.notEnoughItems,l=a.state.items,p=a.state.voteTitle,i=a.state.multipleCheck,u=a.state.expansionCheck,c=!!a.state.autoCloseNumber&&parseInt(a.state.autoCloseNumber,10),d={title:p,items:l,multiple:i,expansion:u,closed:!1};return console.log(c),c&&!Number.isNaN(c)&&(d.autoClose=c),p&&p.trim()?d.items.length<2?a.setState({showMessage:!0,errorMessage:r}):(a.setState({data:d,showMessage:!1,multiple:i,expansion:u,autoClose:c,items:l}),o&&"function"==typeof o&&o(d),!t||"function"!=typeof t||t(d.title,d)):a.setState({showMessage:!0,errorMessage:n})},a.expandVote=function(){var e=a.props,t=e.onExpand,o=e.getData,s=a.state.expansionInput;if(!s||!s.trim())return!1;var n=a.state.data,r={title:s,count:0,voters:[]};return n.items.push(r),a.setState({data:n,items:n.items,expansionInput:""}),o&&"function"==typeof o&&o(n),!t||"function"!=typeof t||t(n.title,r,n)},a.showResult=function(){a.setState({showResult:!0})},a.showVoting=function(){a.setState({showResult:!1})},a.closeVote=function(){var e=a.props,t=e.getData,o=e.onClose,s=a.state.data;s.closed=!0,a.setState({data:s}),t&&"function"==typeof t&&t(s),o&&"function"==typeof o&&o(s.title,s)},a.upvote=function(e){var t=a.state,o=t.items,s=t.data,n=t.autoClose,r=a.props,l=r.getData,p=r.onUpvote,i=o.reduce(function(e,t){return e+t.count},0);o[e].count+=1,o[e].voted=!0;var u=a.props.clientId;return o[e].voters||(o[e].voters=[]),o[e].voters.push(u),s.items=o,s.voters?s.voters.indexOf(u)===-1&&s.voters.push(u):s.voters=[u],a.setState({voted:!0,items:o,data:s}),l&&"function"==typeof l&&l(s,o[e].title),p&&"function"==typeof p&&p(s.title,e,s),!(n&&i+1>=n)||a.closeVote()},a.renderItems=function(e){var t=0;return u.default.createElement("div",null,e.map(function(e){var o=t,s=a.props,n=s.styles,r=s.text,l=s.clientId,p=l&&e.voters&&e.voters.indexOf(l)>-1,i=e.voted||p?u.default.createElement("span",{className:n.votedText},r.votedText):(a.state.multiple||!a.state.voted)&&u.default.createElement("button",{onClick:function(){return a.upvote(o)},className:n.voteButton},r.voteButtonText),c=u.default.createElement("div",{key:"react-vote-item-"+o,className:n.itemWrapper},u.default.createElement("div",{className:n.itemTitle},e.title),a.state.data.title?i:u.default.createElement("button",{onClick:function(){return a.removeItem(o)},className:n.removeButton},r.removeButtonText));return t+=1,c}))},a.renderResult=function(e){var t=0,o=e.reduce(function(e,t){return e+t.count},0),s=a.props.styles,n=a.props.clientId&&!a.state.multiple&&a.state.data.voters.indexOf(a.props.clientId)>-1,r=a.props.text;return u.default.createElement("div",null,u.default.createElement("div",{className:s.voteTitle},a.state.data.title),u.default.createElement("div",null,e.map(function(e){var a=0===o?0:(e.count/o*100).toFixed(2),n=u.default.createElement("div",{key:"react-vote-result-"+t,className:s.itemWrapper},u.default.createElement("div",{className:s.itemTitle},e.title),u.default.createElement("div",{className:s.itemCount},e.count+"("+a+"%)"));return t+=1,n}),a.state.total&&u.default.createElement("div",{className:s.itemWrapper},u.default.createElement("div",{className:s.itemTitle},r.totalText),u.default.createElement("div",{className:s.itemCount},o))),!a.state.data.closed&&!n&&u.default.createElement("div",{className:s.buttonWrapper},u.default.createElement("button",{className:s.goBackButton,onClick:a.showVoting},r.goBackButtonText)))},r=o,n(a,r)}return r(t,e),p(t,[{key:"componentWillMount",value:function(){this.props.getData&&this.props.getData&&console.error("props getData is deprecated. Please use onCreate, onUpvote, onClose, onExpand instead. getData will be deleted next update and it will break your application")}},{key:"componentWillReceiveProps",value:function(e){e.data&&this.setState({data:e.data,items:e.data.items,isAdmin:e.isAdmin})}},{key:"renderCreationView",value:function(){var e=this.props,t=e.styles,o=e.text;return u.default.createElement("div",null,u.default.createElement("input",{className:t.titleInput,value:this.state.voteTitle,onChange:this.onVoteTitleChange,placeholder:o.titleInputPlaceholder}),u.default.createElement("div",{className:t.addWrapper},this.renderItems(this.state.items),u.default.createElement("div",null,u.default.createElement("input",{className:t.addInput,value:this.state.addInput,onChange:this.onAddInputChange,placeholder:o.addInputPlaceholder}),u.default.createElement("button",{className:t.addButton,onClick:this.addItem},o.addButtonText)),u.default.createElement("div",null,u.default.createElement("label",{htmlFor:"multiple"},o.multipleCheckbox,u.default.createElement("input",{id:"multiple",type:"checkbox",checked:this.state.multipleCheck,onChange:this.onMultipleCheckChange}))," ",u.default.createElement("label",{htmlFor:"expansion"},o.expansionCheckbox,u.default.createElement("input",{id:"expansion",type:"checkbox",checked:this.state.expansionCheck,onChange:this.onExpansionCheckChange}))," ",u.default.createElement("label",{htmlFor:"autoClose"},o.autoCloseText,u.default.createElement("input",{id:"autoClose",value:this.state.autoClose,onChange:this.onAutoCloseChange,placeholder:o.autoClosePlaceholder})))),this.state.showMessage&&u.default.createElement("div",{className:t.errorMessage},this.state.errorMessage),u.default.createElement("div",{className:t.buttonWrapper},u.default.createElement("button",{className:t.createButton,onClick:this.createVote},o.createButtonText)))}},{key:"render",value:function(){var e=this.props,t=e.styles,o=e.text,a=e.clientId,s=a&&!this.state.multiple&&this.state.data.voters.indexOf(a)>-1,n=this.state.data.closed,r=this.state.data.title&&(n||this.state.showResult||s),l=this.state.expansion&&(!this.state.voted||this.state.multiple),p=r?this.renderResult(this.state.items):u.default.createElement("div",null,u.default.createElement("div",{className:t.voteTitle},this.state.data.title),this.renderItems(this.state.items),l&&u.default.createElement("div",{className:t.itemWrapper},u.default.createElement("input",{className:t.expansionInput,value:this.state.expansionInput,onChange:this.onExpansionInputChange,placeholder:o.expansionPlaceholder}),u.default.createElement("button",{className:t.expansionButton,onClick:this.expandVote},o.expansionButtonText)),u.default.createElement("div",{className:t.buttonWrapper},u.default.createElement("button",{className:t.resultButton,onClick:this.showResult},o.resultButtonText),this.state.isAdmin&&u.default.createElement("button",{className:t.closeButton,onClick:this.closeVote},o.closeButtonText)));return u.default.createElement("div",{className:t.voteWrapper},this.state.data.title?p:this.renderCreationView())}}]),t}(i.Component);c.propTypes={isAdmin:i.PropTypes.bool,total:i.PropTypes.bool,multiple:i.PropTypes.bool,clientId:i.PropTypes.oneOfType([i.PropTypes.string,i.PropTypes.number]),data:i.PropTypes.shape({title:i.PropTypes.string.isRequired,voters:i.PropTypes.arrayOf(i.PropTypes.oneOfType([i.PropTypes.string,i.PropTypes.number])),items:i.PropTypes.arrayOf(i.PropTypes.object).isRequired,closed:i.PropTypes.bool}),autoClose:i.PropTypes.number,expansion:i.PropTypes.bool,styles:i.PropTypes.shape({voteWrapper:i.PropTypes.string,voteTitle:i.PropTypes.string,titleInput:i.PropTypes.string,addWrapper:i.PropTypes.string,addInput:i.PropTypes.string,addButton:i.PropTypes.string,itemTitle:i.PropTypes.string,itemCount:i.PropTypes.string,itemWrapper:i.PropTypes.string,buttonWrapper:i.PropTypes.string,removeButton:i.PropTypes.string,createButton:i.PropTypes.string,resultButton:i.PropTypes.string,goBackButton:i.PropTypes.string,voteButton:i.PropTypes.string,closeButton:i.PropTypes.string,errorMessage:i.PropTypes.string,votedText:i.PropTypes.string,expansionButton:i.PropTypes.string,expansionInput:i.PropTypes.string}),getData:i.PropTypes.func,onCreate:i.PropTypes.func,onUpvote:i.PropTypes.func,onExpand:i.PropTypes.func,onClose:i.PropTypes.func,text:i.PropTypes.shape({titleInputPlaceholder:i.PropTypes.string,addInputPlaceholder:i.PropTypes.string,addButtonText:i.PropTypes.string,removeButtonText:i.PropTypes.string,closeButtonText:i.PropTypes.string,createButtonText:i.PropTypes.string,resultButtonText:i.PropTypes.string,goBackButtonText:i.PropTypes.string,voteButtonText:i.PropTypes.string,votedText:i.PropTypes.string,totalText:i.PropTypes.string,multipleCheckbox:i.PropTypes.string,expansionCheckbox:i.PropTypes.string,expansionPlaceholder:i.PropTypes.string,expansionButtonText:i.PropTypes.string,autoCloseText:i.PropTypes.string,autoClosePlaceholder:i.PropTypes.string}),errorMessage:i.PropTypes.shape({notEnoughItems:i.PropTypes.string,noTitle:i.PropTypes.string})},c.defaultProps={isAdmin:!1,multiple:!1,total:!0,expansion:!1,voted:!1,text:{addButtonText:"Add",titleInputPlaceholder:"Title of this vote",addInputPlaceholder:"Type title of new option here",removeButtonText:"×",closeButtonText:"Close vote",createButtonText:"Create",resultButtonText:"Show result",goBackButtonText:"Go back to vote",voteButtonText:"Upvote",votedText:"Voted",totalText:"Total",multipleCheckbox:"Multiple choice?",expansionCheckbox:"Expandable?",expansionPlaceholder:"Add an option yourself",expansionButtonText:"Add",autoCloseText:"AutoClose number: ",autoClosePlaceholder:"type autoClose number"},errorMessage:{notEnoughItems:"Need at least 2 item!",noTitle:"Need a title!"},styles:{}},t.default=c},function(e,t){e.exports=require("react")}]);
//# sourceMappingURL=react-vote.js.map